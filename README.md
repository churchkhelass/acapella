# Withdraw App

Приложение для вывода средств с защитой от двойного сабмита, идемпотентностью и восстановлением состояния после перезагрузки.

## Запуск проекта

```bash
# Установка зависимостей
npm install

# Запуск в режиме разработки
npm run dev

# Сборка для production
npm run build

# Запуск production сборки
npm start

# Запуск тестов
npm test

# Запуск тестов в watch режиме
npm run test:watch


---------------------------------------------
## Хранение токена
---------------------------------------------

JWT токен должен храниться в httpOnly cookie
CSRF токен для дополнительной защиты
Refresh token механизм для обновления сессий

---------------------------------------------
## Структура проекта
---------------------------------------------

src/
├── app/              # Next.js App Router страницы
├── components/       # React компоненты
│   ├── ui/          # Переиспользуемые UI компоненты
│   └── *.tsx        # Бизнес-компоненты
├── lib/              # Бизнес-логика
│   ├── api/         # API клиенты
│   ├── store/       # Zustand store
│   └── utils/       # Утилиты
├── types/            # TypeScript типы
__tests__/            # Тесты

---------------------------------------------
## Технологии
---------------------------------------------

Next.js 14 (App Router)
TypeScript
Zustand (state management)
TailwindCSS (стилизация)
Jest + React Testing Library (тесты)

---------------------------------------------
## Производительность
---------------------------------------------

Мемоизация компонентов (React.memo)
Оптимизированные селекторы Zustand
Ленивая загрузка где необходимо
Предотвращение лишних ререндеров

---------------------------------------------
## State Management (Zustand)
---------------------------------------------

Использован Zustand вместо Redux для простоты и производительности
Persist middleware для сохранения последней заявки в localStorage
Автоматическое восстановление состояния при перезагрузке (до 5 минут)
Мемоизированные селекторы для оптимизации рендеров

---------------------------------------------
## 2. API слой
---------------------------------------------
Реализован retry механизм с экспоненциальной задержкой (3 попытки)
Idempotency ключи для защиты от дублирования транзакций
Обработка специфических ошибок (409 Conflict)
Типизированные ответы и ошибки

---------------------------------------------
## 3. Безопасность
---------------------------------------------
Access token не хранится в localStorage
Для production: токены должны храниться в httpOnly cookies
Санитизация пользовательского ввода
Защита от XSS через React (автоматическое экранирование)

---------------------------------------------
## 4. UI/UX
---------------------------------------------

Валидация на уровне формы с подсветкой ошибок
Debounced валидация для производительности
Состояния idle/loading/success/error
Защита от двойного сабмита на уровне UI и API

---------------------------------------------
## Тестирование
---------------------------------------------

Проект покрыт unit-тестами:
Happy path submit
Обработка ошибок API
Защита от двойного submit
Валидация формы

---------------------------------------------



⣿⣿⣿⣿⣿⣿⣿⡿⠛⠉⠉⠉⠉⠛⠻⣿⣿⠿⠛⠛⠙⠛⠻⣿⣿⣿⣿⣿
⣿⣿⣿⣿⣿⠟⠁⠀⠀⠀⢀⣀⣀⡀⠀⠈⢄⠀⠀⠀⠀⠀⠀⠀⢻⣿⣿⣿
⣿⣿⣿⣿⠏⠀⠀⠀⠔⠉⠁⠀⠀⠈⠉⠓⢼⡤⠔⠒⠀⠐⠒⠢⠌⠿⣿⣿
⣿⣿⣿⡏⠀⠀⠀⠀⠀⠀⢀⠤⣒⠶⠤⠭⠭⢝⡢⣄⢤⣄⣒⡶⠶⣶⣢⡝
⡿⠋⠁⠀⠀⠀⠀⣀⠲⠮⢕⣽⠖⢩⠉⠙⣷⣶⣮⡍⢉⣴⠆⣭⢉⠑⣶⣿
⠀⠀⠀⠀⠀⠀⠀⠉⠒⠒⠻⣿⣄⠤⠘⢃⣿⣿⡿⠫⣿⣿⣄⠤⠘⢃⣿⣿
⠀⠀⠀⠀⠀⠀⠀⠀⠀⠈⠓⠤⠭⣥⣀⣉⡩⡥⠴⠃⠀⠈⠉⠁⠈⠉⠁⣴
⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⣀⠤⠔⠊⠀⠀⠀⠓⠲⡤⠤⠖⠐⢿⣿
⠀⠀⠀⠀⠀⠀⠀⠀⣠⣄⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⢻
⠀⠀⠀⠀⠀⠀⠀⢸⣿⡻⢷⣤⣀⡀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⣘
⠀⠀⠀⠀⠀⠠⡀⠀⠙⢿⣷⣽⣽⣛⣟⣻⠷⠶⢶⣦⣤⣤⣤⣤⣶⠾⣿⣿
⠀⠀⠀⠀⠀⠀⠉⠂⠀⠀⠀⠈⠉⠙⠛⠻⠿⠿⠿⠿⠶⠶⠶⠶⠾⣿⣿⣿
